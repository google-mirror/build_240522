{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "a9a7d1e0_266685ed",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1967151
      },
      "writtenOn": "2023-06-01T20:53:36Z",
      "side": 1,
      "message": "To clarify (for both BUILD_ID and BUILD_FINGERPRINT), I wish to only change the values of the system properties but not the corresponding Make variables because doing so ensures that the value for ro.build.id and ro.build.fingerprint will be resolved and consistent wherever they are used, while that same guarantee cannot be made for everywhere that BUILD_ID and BUILD_FINGERPRINT is used (because those places may no longer be accessible/may have already created issues by the time the dependencies in the forward declarations are available).",
      "revId": "8a99d5c465ef1867546fb4a5882554b57eff8963",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "bba47600_d5235eba",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1132673
      },
      "writtenOn": "2023-06-02T01:55:23Z",
      "side": 1,
      "message": "Tiffany, I really appreciate your effort of making ARC to be as close as Android. However, unfortunately, this change seems to be heading towards a wrong direction. \n\nIf my understanding is correct, this change is originated from the fact that you don\u0027t run CTS on a correctly release-key signed ARC build. Shouldn\u0027t we instead work on fixing that?\n\nI wish Joe, Colin and Baligh (I invited him) can talk more.",
      "revId": "8a99d5c465ef1867546fb4a5882554b57eff8963",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "b586a6d3_6354b697",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1967151
      },
      "writtenOn": "2023-06-15T19:06:23Z",
      "side": 1,
      "message": "Thanks for meeting with me, Jiyong :). Discussion documented at go/arc-android-sigprop-sync",
      "revId": "8a99d5c465ef1867546fb4a5882554b57eff8963",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "9640f73f_ee2c1a46",
        "filename": "core/sysprop.mk",
        "patchSetId": 1
      },
      "lineNbr": 69,
      "author": {
        "id": 1132673
      },
      "writtenOn": "2023-06-01T02:20:16Z",
      "side": 1,
      "message": "BUILD_FINGERPRINT can be specified externally. See https://source.corp.google.com/android/build/make/core/sysprop.mk;rcl\u003d68c3a6216304963dc5ecc22faa39f2fc0606dee3;l\u003d173",
      "range": {
        "startLine": 69,
        "startChar": 0,
        "endLine": 69,
        "endChar": 78
      },
      "revId": "8a99d5c465ef1867546fb4a5882554b57eff8963",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "1a9e9e94_f6de09ef",
        "filename": "core/sysprop.mk",
        "patchSetId": 1
      },
      "lineNbr": 69,
      "author": {
        "id": 1967151
      },
      "writtenOn": "2023-06-01T20:46:11Z",
      "side": 1,
      "message": "This looks like it could work, but I\u0027m hesitant to change the value of the Make variable itself because there are other places where BUILD_FINGERPRINT_FROM_FILE is referenced (e.g., ImageSpec) that work for the Android version of a build_fingerprint that would not be touched/resolved by Android image post-processing during ChromeOS build.",
      "parentUuid": "9640f73f_ee2c1a46",
      "range": {
        "startLine": 69,
        "startChar": 0,
        "endLine": 69,
        "endChar": 78
      },
      "revId": "8a99d5c465ef1867546fb4a5882554b57eff8963",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "1ba8ff81_129f69de",
        "filename": "core/sysprop.mk",
        "patchSetId": 1
      },
      "lineNbr": 69,
      "author": {
        "id": 1132673
      },
      "writtenOn": "2023-06-02T01:55:23Z",
      "side": 1,
      "message": "Are you saying that ARC uses two different fingerprints? ex: for sysprops, you use the chromeos-defined one, while for imagespec you use the android-defined one? That sounds more dangerous.",
      "parentUuid": "1a9e9e94_f6de09ef",
      "range": {
        "startLine": 69,
        "startChar": 0,
        "endLine": 69,
        "endChar": 78
      },
      "revId": "8a99d5c465ef1867546fb4a5882554b57eff8963",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "7c270704_882ba810",
        "filename": "core/sysprop.mk",
        "patchSetId": 1
      },
      "lineNbr": 69,
      "author": {
        "id": 1967151
      },
      "writtenOn": "2023-06-15T19:06:23Z",
      "side": 1,
      "message": "Discussed offline. image_spec is only used in local eng contexts/builds, so the issue of multiple fingerprints will never be seen in official builds. Since we would prefer not to define Make variables that can be used elsewhere with special characters (e.g., with the curly brackets used for forward declarations), we prefer re-defining the system properties rather than setting those variables.",
      "parentUuid": "1ba8ff81_129f69de",
      "range": {
        "startLine": 69,
        "startChar": 0,
        "endLine": 69,
        "endChar": 78
      },
      "revId": "8a99d5c465ef1867546fb4a5882554b57eff8963",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "f28eda02_c7b2701c",
        "filename": "core/sysprop.mk",
        "patchSetId": 1
      },
      "lineNbr": 69,
      "author": {
        "id": 1967151
      },
      "writtenOn": "2023-07-12T18:33:30Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "7c270704_882ba810",
      "range": {
        "startLine": 69,
        "startChar": 0,
        "endLine": 69,
        "endChar": 78
      },
      "revId": "8a99d5c465ef1867546fb4a5882554b57eff8963",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "fc146c8c_aad62715",
        "filename": "core/sysprop.mk",
        "patchSetId": 1
      },
      "lineNbr": 70,
      "author": {
        "id": 1132673
      },
      "writtenOn": "2023-06-01T02:20:16Z",
      "side": 1,
      "message": "IIUC, BUILD_ID can be overridden by having your own build/make/core/build_id.mk file.",
      "range": {
        "startLine": 70,
        "startChar": 0,
        "endLine": 70,
        "endChar": 50
      },
      "revId": "8a99d5c465ef1867546fb4a5882554b57eff8963",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "b7e58dea_667386e5",
        "filename": "core/sysprop.mk",
        "patchSetId": 1
      },
      "lineNbr": 70,
      "author": {
        "id": 1967151
      },
      "writtenOn": "2023-06-01T20:46:11Z",
      "side": 1,
      "message": "Thanks for this pointer! It looks like BUILD_ID is used in other Make variables (e.g., thumbprint) that aren\u0027t referenced by ChromeOS build later on but may be relevant to Android build. I am hesitant to change the values of those variables themselves because I don\u0027t know if there are other places where the system may encounter the intermediate form of the variable (e.g., R{envvar:CHROME_BRANCH}-{envvar:CHROMEOS_VERSION_STRING}) while expecting a complete word.",
      "parentUuid": "fc146c8c_aad62715",
      "range": {
        "startLine": 70,
        "startChar": 0,
        "endLine": 70,
        "endChar": 50
      },
      "revId": "8a99d5c465ef1867546fb4a5882554b57eff8963",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "f98e9c75_fc23983d",
        "filename": "core/sysprop.mk",
        "patchSetId": 1
      },
      "lineNbr": 70,
      "author": {
        "id": 1132673
      },
      "writtenOn": "2023-06-02T01:55:23Z",
      "side": 1,
      "message": "This is same as above. If ARC wants to override BUILD_ID, it should be consistent across the build. Changing only the value ro.build.id while leaving other places sounds very wrong to me.",
      "parentUuid": "b7e58dea_667386e5",
      "range": {
        "startLine": 70,
        "startChar": 0,
        "endLine": 70,
        "endChar": 50
      },
      "revId": "8a99d5c465ef1867546fb4a5882554b57eff8963",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "d933210b_d3b588e6",
        "filename": "core/sysprop.mk",
        "patchSetId": 1
      },
      "lineNbr": 70,
      "author": {
        "id": 1967151
      },
      "writtenOn": "2023-06-15T19:06:23Z",
      "side": 1,
      "message": "See comment above -- we prefer not to set Make variables with special characters.",
      "parentUuid": "f98e9c75_fc23983d",
      "range": {
        "startLine": 70,
        "startChar": 0,
        "endLine": 70,
        "endChar": 50
      },
      "revId": "8a99d5c465ef1867546fb4a5882554b57eff8963",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "07467700_1497ee53",
        "filename": "core/sysprop.mk",
        "patchSetId": 1
      },
      "lineNbr": 71,
      "author": {
        "id": 1132673
      },
      "writtenOn": "2023-06-01T02:20:16Z",
      "side": 1,
      "message": "I think this really has to be release-key only when the build is actually is release-key signed.. by the CrOS signing script.",
      "range": {
        "startLine": 71,
        "startChar": 0,
        "endLine": 71,
        "endChar": 62
      },
      "revId": "8a99d5c465ef1867546fb4a5882554b57eff8963",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "1a47d7f5_ee6346ab",
        "filename": "core/sysprop.mk",
        "patchSetId": 1
      },
      "lineNbr": 71,
      "author": {
        "id": 1967151
      },
      "writtenOn": "2023-06-01T20:46:11Z",
      "side": 1,
      "message": "No, unfortunately all user builds have to be release-key signed because we have to run CTS tests on ChromeOS test images (which cannot be release-key signed) on android user images. We cannot run CTS tests on ChromeOS release builds because certain tooling required to test the ARC build (e.g., adb, etc) is only available on ChromeOS test builds. I looked into running a separate signing step over only the Android image during the ChromeOS test build, but since we would not be signing with actual release keys (because it is not technically a release build) and it wouldn\u0027t make sense to create a new set of dev-keys for this specific case, we would effectively be adding significant overhead to each test build in order to do essentially a no-op (aka re-signing the Android build with the same dev keys) and change the tag from \"dev-keys\" to \"release-keys\".\n\nI know this doesn\u0027t seem like the best system, but for ARC builds it is helpful to think about ro.build.tags as not the keys that the whole image is signed, but the keys with which the GMS APK is signed. Since we always use signed a GMS APK Prebuilt in ARC user images, setting the tags to release-key here will always be consistent.",
      "parentUuid": "07467700_1497ee53",
      "range": {
        "startLine": 71,
        "startChar": 0,
        "endLine": 71,
        "endChar": 62
      },
      "revId": "8a99d5c465ef1867546fb4a5882554b57eff8963",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "04e37305_c1c5f664",
        "filename": "core/sysprop.mk",
        "patchSetId": 1
      },
      "lineNbr": 71,
      "author": {
        "id": 1132673
      },
      "writtenOn": "2023-06-02T01:55:23Z",
      "side": 1,
      "message": "\u003e but since we would not be signing with actual release keys (because it is not technically a release build) \n\nAs I commented in the doc, IMO, this is wrong. CTS has to run on the final software that you deliver to the user; variant\u003duser \u0026\u0026 release-key signed. Just changing the tag sysprop to release-key is not a correct way of signing.",
      "parentUuid": "1a47d7f5_ee6346ab",
      "range": {
        "startLine": 71,
        "startChar": 0,
        "endLine": 71,
        "endChar": 62
      },
      "revId": "8a99d5c465ef1867546fb4a5882554b57eff8963",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "ea3966f7_c936025a",
        "filename": "core/sysprop.mk",
        "patchSetId": 1
      },
      "lineNbr": 71,
      "author": {
        "id": 1967151
      },
      "writtenOn": "2023-06-15T19:06:23Z",
      "side": 1,
      "message": "Discussed offline. Reasoning and goals documented at go/arc-android-sigprop-sync",
      "parentUuid": "04e37305_c1c5f664",
      "range": {
        "startLine": 71,
        "startChar": 0,
        "endLine": 71,
        "endChar": 62
      },
      "revId": "8a99d5c465ef1867546fb4a5882554b57eff8963",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "15ca4b87_0f90b015",
        "filename": "tools/buildinfo.sh",
        "patchSetId": 1
      },
      "lineNbr": 52,
      "author": {
        "id": 1132673
      },
      "writtenOn": "2023-06-01T02:20:16Z",
      "side": 1,
      "message": "Why do you have to override this?",
      "range": {
        "startLine": 52,
        "startChar": 6,
        "endLine": 52,
        "endChar": 48
      },
      "revId": "8a99d5c465ef1867546fb4a5882554b57eff8963",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "c41491f7_863f5839",
        "filename": "tools/buildinfo.sh",
        "patchSetId": 1
      },
      "lineNbr": 52,
      "author": {
        "id": 1967151
      },
      "writtenOn": "2023-06-01T20:46:11Z",
      "side": 1,
      "message": "The build description is set differently in ARC. It has components like the ChromeOS product and device",
      "parentUuid": "15ca4b87_0f90b015",
      "range": {
        "startLine": 52,
        "startChar": 6,
        "endLine": 52,
        "endChar": 48
      },
      "revId": "8a99d5c465ef1867546fb4a5882554b57eff8963",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "ebbda8d1_c32f08b0",
        "filename": "tools/buildinfo.sh",
        "patchSetId": 1
      },
      "lineNbr": 52,
      "author": {
        "id": 1132673
      },
      "writtenOn": "2023-06-02T01:55:23Z",
      "side": 1,
      "message": "This is only for human. Who is supposed to read this? ARC doesn\u0027t have the settings menu, does it?",
      "parentUuid": "c41491f7_863f5839",
      "range": {
        "startLine": 52,
        "startChar": 6,
        "endLine": 52,
        "endChar": 48
      },
      "revId": "8a99d5c465ef1867546fb4a5882554b57eff8963",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "1ac4521e_2522ad3c",
        "filename": "tools/buildinfo.sh",
        "patchSetId": 1
      },
      "lineNbr": 52,
      "author": {
        "id": 1967151
      },
      "writtenOn": "2023-06-15T19:06:23Z",
      "side": 1,
      "message": "We use the ro.build.description field in automated bug report emails, and the description we set has more relevant information about the device.",
      "parentUuid": "ebbda8d1_c32f08b0",
      "range": {
        "startLine": 52,
        "startChar": 6,
        "endLine": 52,
        "endChar": 48
      },
      "revId": "8a99d5c465ef1867546fb4a5882554b57eff8963",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    }
  ]
}